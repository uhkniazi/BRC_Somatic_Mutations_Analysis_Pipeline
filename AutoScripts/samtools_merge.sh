#!/bin/bash -l
#SBATCH --job-name=samtools-array
#SBATCH --array=1-1
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --time=6-05:05:00
#SBATCH --partition brc
#SBATCH --mem-per-cpu=10000MB
#SBATCH --mail-type=END,FAIL
# Autogenerated script from write_samtools_script.R
# date Thu Oct 28 11:21:33 2021
# make sure directory paths exist before running script



module load apps/samtools/1.10.0-singularity



# Parse parameter file to get variables.
           number=$SLURM_ARRAY_TASK_ID
           paramfile=samtools_merge_param.txt
           
           merged=`sed -n ${number}p $paramfile | awk '{print $1}'`
           bamfiles=`sed -n ${number}p $paramfile | cut -f 2- -d ' '`
           
           # 9. Run the program.
samtools merge $merged $bamfiles
samtools index $merged



